/*! For license information please see main.min.js.LICENSE.txt */
!function(){"use strict";let e,t,a,i,l,n,o,r,s,c=document.location.hostname;function p(e,t=!0){t?$(".plyr__loading").html(e):$(".plyr__loading").append(e)}function d(){if(p("失败, Ai换源中...",!1),a<=1)return p("无备用源...",!1);if(s<=0)return p("地域限制 或 源全失效, 终止Ai...",!1);let i=(t.indexOf(e)+1)%a;e=t[i],s--,u(!1)}function u(t=!0){p(e+"...",t),t&&($(".plyr__poster").css("opacity",1),$(".plyr__gifs").css("opacity",1)),l=playUrls[e],Hls.isSupported()?(r.loadSource(l),r.attachMedia(n)):n.src=l,o.play().catch((function(e){f(e)}))}function f(e){"NotAllowedError"===e.name&&($(".plyr__gifs").css("opacity",0),$(".plyr").addClass("plyr--paused-browser"),p("请点(▶️)播放...",!1))}function h(e,t,a,i){let l=localStorage.getItem("history")?JSON.parse(localStorage.getItem("history")):[];if("add"===e){let e={id:t,title:a,url:i},n=l.findIndex((function(e){return e.id===t}));n>-1&&l.splice(n,1),l.unshift(e),l.length>10&&l.pop(),localStorage.setItem("history",JSON.stringify(l)),h()}else{let e="";if(l.length>0)for(var n=0;n<l.length;n++)e+='<a href="'+l[n].url+'">'+l[n].title+"</a>";else e="没有播放记录";$(".dropdown-content").html(e)}}$((function(){const g="//"+c+"/wp-admin/admin-ajax.php";if($("#player").length>0){e=localStorage.getItem("playform"),t=Object.keys(playUrls),a=t.length,s=2*a,e=e&&e in playUrls?e:t[0],p(e+"...",!1);const c=$('link[rel="canonical"]').attr("href");i=window.btoa(c),l=playUrls[e],n=document.querySelector("video"),o=new Plyr(n,{ratio:"16:9",autoplay:!0,controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],i18n:{speed:"倍速",normal:"默认"},fullscreen:{enabled:!0,fallback:!0,iosNative:!0,container:null},speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2]}}),Hls.isSupported()?(r=new Hls({autoStartLoad:!0,maxBufferSize:1e6}),r.loadSource(l),r.attachMedia(n),r.on(Hls.Events.ERROR,(function(e,t){!t.fatal||t.type!==Hls.ErrorTypes.NETWORK_ERROR||t.details!==Hls.ErrorDetails.MANIFEST_LOAD_ERROR&&t.details!==Hls.ErrorDetails.MANIFEST_LOAD_TIMEOUT||(console.log(t.details),d())}))):(n.src=l,n.addEventListener("error",(function(e){console.log("错误事件",e),d()}))),o.play().catch((function(e){f(e)})),n.addEventListener("loadeddata",(()=>{$(".plyr__poster").css("opacity",0),$(".plyr__gifs").css("opacity",0),p("成功",!1),localStorage.setItem("playform",e)})),n.addEventListener("loadedmetadata",(()=>{let e=localStorage.getItem(i);n.currentTime=e?parseFloat(e):0}));let u=0;n.addEventListener("timeupdate",(()=>{let e=Math.floor(n.currentTime);e-u>=1&&(u=e,localStorage.setItem(i,e.toString()))}));const g=$("#views").data("id"),y=$("h1").text();g&&y&&c&&h("add",g,y,c)}else h();if($(".plyr__switch").on("click",(function(){if(a<=1)return p("...无备用源",!1);let i=t.indexOf(e);i++,i=i>=a?0:i,e=t[i],u(!0)})),$("#search").on("submit",(function(e){try{var t=this.q.value.trim();if(!t)return this.q.focus(),void e.preventDefault();var a=$(this).data("url");if(a){var i=encodeURIComponent(t.replace(/[ ]+/g,"-").replace(/[']/g,"").replace(/[&]/g,"%26").replace(/[?]/g,"%3F").replace(/[/]/g,"%2F"));window.location=a.replace("%QUERY%",i),e.preventDefault()}}catch(e){console.error(e)}})),$(".swiper-container").each((function(){var e=!!$(this).data("breakpoints")&&$(this).data("breakpoints"),t=!!$(this).data("slidesperview")&&$(this).data("slidesperview"),a=!!$(this).data("freemode"),i=!!$(this).data("autoplay")&&$(this).data("autoplay"),l=!!$(this).data("pagination"),n=!!$(this).data("navigation"),o=!!$(this).data("loop"),r=!!$(this).data("center"),s=$(this).data("space")?$(this).data("space"):0,c=$(this).data("name")?$(this).data("name"):"",p=$(this).data("position")?$(this).data("position"):0,d={};o&&(d.loop=o,d.loopFillGroupWithBlank=!0),a&&(d.freeMode=a),i&&(d.autoplay={delay:i,disableOnInteraction:!1}),r&&(d.centeredSlides=r),s&&(d.spaceBetween=s),e&&(d.breakpoints=function(e){const t=e.split("|"),a={};for(let e=0;e<t.length;e++){const i=t[e].split(":"),l=i[0],n=parseInt(i[1],10);a[l]={slidesPerView:n},a[l].slidesPerGroup=n}return a}(e)),t&&(d.slidesPerView=t,d.slidesPerGroup=t),l&&(d.pagination={el:".swiper-pagination",clickable:!0}),n&&(d.navigation={nextEl:"."+c+" .swiper-next",prevEl:"."+c+" .swiper-prev"}),console.log(d);var u=new Swiper("."+c+"-swiper",d);p>0&&u.slideTo(p,1e3,!1)})),$("#views").length>0){var y=$("#views").data("id"),m=$("#views").data("sign");$.ajax({url:g,type:"POST",data:{action:"views",id:y,sign:m},success:function(e){}})}$(".toggle-button").on("click",(function(){$(this).parent().toggleClass("expanded")})),$(".eps-prev").on("click",(function(){let e=$(".list-ep.active").parent().next();e.length&&(window.location.href=e.find("a").attr("href"))}))}))}();
//# sourceMappingURL=main.min.js.map